(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{234:function(t,e,n){"use strict";(function(t,e){var o=n(4);n(26);o(n(25));var r=o(n(235));t.__webpack_require_UNI_MP_PLUGIN__=n,e(r.default)}).call(this,n(1)["default"],n(2)["createPage"])},235:function(t,e,n){"use strict";n.r(e);var o=n(236),r=n(238);for(var i in r)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(i);n(240);var a,s=n(32),u=Object(s["default"])(r["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],a);u.options.__file="pages/order/order.vue",e["default"]=u.exports},236:function(t,e,n){"use strict";n.r(e);var o=n(237);n.d(e,"render",(function(){return o["render"]})),n.d(e,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(e,"components",(function(){return o["components"]}))},237:function(t,e,n){"use strict";var o;n.r(e),n.d(e,"render",(function(){return r})),n.d(e,"staticRenderFns",(function(){return a})),n.d(e,"recyclableRender",(function(){return i})),n.d(e,"components",(function(){return o}));try{o={empty:function(){return n.e("components/empty/empty").then(n.bind(null,401))},uniLoadMore:function(){return n.e("components/uni-load-more/uni-load-more").then(n.bind(null,408))}}}catch(s){if(-1===s.message.indexOf("Cannot find module")||-1===s.message.indexOf(".vue"))throw s;console.error(s.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var t=this,e=t.$createElement,n=(t._self._c,t.__map(t.orderList,(function(e,n){var o=t.__get_orig(e),r=t.$getDateStr(e.createAt),i=e.goodsInfo.length,a=e.goodsInfo.length,s=t.getCount(e),u=t.getAmount(e);return{$orig:o,m0:r,g0:i,g1:a,m1:s,m2:u}}))),o=t.orderList.length;t.$mp.data=Object.assign({},{$root:{l0:n,g2:o}})},i=!1,a=[];r._withStripped=!0},238:function(t,e,n){"use strict";n.r(e);var o=n(239),r=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=r.a},239:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(){n.e("components/uni-load-more/uni-load-more").then(function(){return resolve(n(408))}.bind(null,n)).catch(n.oe)},r=function(){n.e("components/empty/empty").then(function(){return resolve(n(401))}.bind(null,n)).catch(n.oe)},i={components:{uniLoadMore:o,empty:r},data:function(){var t=this.getConst(),e=this.getUser();return{conf:t,tabCurrentIndex:0,navList:[{state:0,text:"全部"},{state:"待支付",text:"待付款"},{state:"待发货",text:"待发货"},{state:"待收货",text:"待收货"},{state:"已完成",text:"已完成"}],userInfo:e,cond:{page:1,pageSize:10,status:""},orderList:[]}},onLoad:function(t){var e=parseInt(t.stat);this.$isNull(e)&&(e=0),this.tabClick(e)},watch:{},onReachBottom:function(){this.load_list()},onPullDownRefresh:function(){},methods:{cancelOrder:function(t){var e=this;this.$comfirm("订单还没有支付,确定要删除吗?",(function(n){e.$put("/mini_core/shop-order/".concat(t.id,"/cancel"),{},(function(t){e.$toast("取消成功"),e.reload_list()}))}))},comfirm:function(t){var e=this;this.$put("/mini_core/shop-order/".concat(t.id,"/confirm"),{},(function(t){e.$toast("确认收货成功"),e.reload_list()}))},topay:function(t){var e=this,n=t.id,o=t.amount-t.benefit+t.postage;this.isWeixin()?this.$post("order/hpj_unifield",{order_id:n},(function(t){if(200==t.status){var n=JSON.parse(t.data),o=n.url;e.$jumpExter(o)}else alert(t.msg)})):this.$redirectTo("/pages/pay/pay?order_id="+n+"&money="+o)},to_comment:function(t){this.$navigateTo("/pages/order/comment?id="+t.id)},showLogistics:function(t){console.log(t);var e={};if(t.postDetail&&(e=JSON.parse(t.postDetail)),"ziti"!=e.type){var n="/pages/order/logister?order="+e.order+"&type="+e.type;this.$navigateTo(n)}else this.$toast("该订单的商品已经自提")},tuikuan:function(e){var n=this;t.showModal({title:"提示",content:"亲，确定要发起退款嘛",success:function(o){if(o.confirm){var r={};r.id=e.id,r.refundStat=1,r.stat=5,n.$post("order/update",r,(function(e){t.showToast({title:"申请成功"}),setTimeout((function(){t.navigateTo({url:"/pages/order/order-refund?state=5"})}),1e3)}))}else o.cancel&&console.log("用户点击取消")}})},to_return:function(t){this.$navigateTo("/pages/order/return?order_id="+t.id)},getAmount:function(t){return t.amount-t.benefit+t.postage},getCount:function(t){return t.goodsInfo.reduce((function(t,e){return t+parseInt(e.buyNum)}),0)},getBillStat:function(t){switch(t){case"待支付":return"待付款";case"待发货":return"待发货";case"待收货":return"待收货";case"已完成":return"已完成";case"已取消":return"已取消";default:return t||"无状态"}},set_stat:function(){this.cond.status=this.tabCurrentIndex,0==this.cond.status&&(this.cond.status="")},reload_list:function(){this.orderList=[],this.cond.page=1,this.load_list()},load_list:function(){var t=this;this.$get("/mini_core/shop-order",this.cond,(function(e){if(e&&e.data){var n=e.data.map((function(t){return{id:t.id,createAt:t.create_time,stat:t.status,statName:t.status,amount:t.actual_amount,benefit:t.discount_amount||0,postage:t.freight_amount||0,orderNo:t.order_no,payMethod:t.pay_method,paymentStatus:t.payment_status,deliveryStatus:t.delivery_status,postDetail:JSON.stringify({type:t.delivery_platform,order:t.express_no,company:t.express_company}),goodsInfo:[{id:t.id,name:"商品信息",image:"/static/img/default-goods.png",price:t.product_amount/t.product_count,buyNum:t.product_count,sku:""}]}}));t.orderList=t.orderList.concat(n),t.cond.page++}}),(function(t){console.error("获取订单列表失败:",t)}))},tabClick:function(t){this.tabCurrentIndex=t,this.set_stat(),this.reload_list()},changeTab:function(t){t.detail.current}}};e.default=i}).call(this,n(2)["default"])},240:function(t,e,n){"use strict";n.r(e);var o=n(241),r=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=r.a},241:function(t,e,n){}},[[234,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/order/order.js.map