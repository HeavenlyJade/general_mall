(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/create"],{226:function(e,t,s){"use strict";(function(e,t){var i=s(4);s(26);i(s(25));var o=i(s(227));e.__webpack_require_UNI_MP_PLUGIN__=s,t(o.default)}).call(this,s(1)["default"],s(2)["createPage"])},227:function(e,t,s){"use strict";s.r(t);var i=s(228),o=s(230);for(var n in o)["default"].indexOf(n)<0&&function(e){s.d(t,e,(function(){return o[e]}))}(n);s(232);var a,r=s(32),d=Object(r["default"])(o["default"],i["render"],i["staticRenderFns"],!1,null,null,null,!1,i["components"],a);d.options.__file="pages/order/create.vue",t["default"]=d.exports},228:function(e,t,s){"use strict";s.r(t);var i=s(229);s.d(t,"render",(function(){return i["render"]})),s.d(t,"staticRenderFns",(function(){return i["staticRenderFns"]})),s.d(t,"recyclableRender",(function(){return i["recyclableRender"]})),s.d(t,"components",(function(){return i["components"]}))},229:function(e,t,s){"use strict";var i;s.r(t),s.d(t,"render",(function(){return o})),s.d(t,"staticRenderFns",(function(){return a})),s.d(t,"recyclableRender",(function(){return n})),s.d(t,"components",(function(){return i}));var o=function(){var e=this,t=e.$createElement,s=(e._self._c,e.round2pos(e.goodsTotal-e.cur_coupon.price+e.postage));e.$mp.data=Object.assign({},{$root:{m0:s}})},n=!1,a=[];o._withStripped=!0},230:function(e,t,s){"use strict";s.r(t);var i=s(231),o=s.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){s.d(t,e,(function(){return i[e]}))}(n);t["default"]=o.a},231:function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s={data:function(){return{maskState:0,desc:"",payType:1,couponList:[{title:"新用户专享优惠券",price:5},{title:"庆五一发一波优惠券",price:10},{title:"优惠券优惠券优惠券优惠券",price:15}],cur_coupon:{title:"",price:0},addressData:{name:"点击添加收货地址",pickerText:"",addressName:"",area:""},addressList:[],postage:0,goods:{},sku:{},goods_list:[],userInfo:{id:-1},submit_lock:0,goodsTotal:0}},onLoad:function(e){},onShow:function(){this.loadData(),this.loadAddress()},watch:{goods_list:{handler:function(e,t){this.calcGoodsAmount()},deep:!0}},methods:{round2pos:function(e){return this.$round2pos(e)},locateAddress:function(e){var t=this.addressList,s=!1;for(var i in console.log("1223",t),t){var o=t[i];if(console.log("123",o),1==o.is_default){this.addressData={name:o.receiver_name,mobile:o.receiver_phone,pickerText:"".concat(o.province,"-").concat(o.city,"-").concat(o.district),addressName:o.detail_address,area:""},s=!0;break}}if(console.log("111this.addressData ",this.addressData),!s&&t.length>0){var n=t[0];this.addressData={name:n.receiver_name,mobile:n.receiver_phone,pickerText:"".concat(n.province,"-").concat(n.city,"-").concat(n.district),addressName:n.detail_address,area:""}}this.postage=0;var a=this.addressData.pickerText.split("-"),r=a[0];(r.indexOf("新疆")>-1||r.indexOf("青海")>-1||r.indexOf("西藏")>-1)&&(this.postage=15),(r.indexOf("黑龙江")>-1||r.indexOf("吉林")>-1||r.indexOf("内蒙古")>-1||r.indexOf("甘肃")>-1||r.indexOf("宁夏")>-1)&&(this.postage=9),r.indexOf("北京")>-1&&(this.postage=10)},loadAddress:function(){var t=this,s=this.getUser()||{};if(!s.id)return e.hideLoading(),void this.$toast("请先登录");var i=this;this.$get("/wx_mini_app/wx_auth/address/".concat(s.id),{},(function(s){e.hideLoading(),s&&s.items?(console.log("res.items",s.items),i.addressList=s.items,console.log("11this.addressList",t.addressList),t.locateAddress()):i.addressList=[]}),(function(t){e.hideLoading(),console.error("获取地址列表失败:",t),i.$toast("获取地址列表失败"),i.addressList=[]}))},loadData:function(){this.goods_list=this.$dataLocal("buy_list"),this.calcGoodsAmount(),this.userInfo=this.getUser()},calcGoodsAmount:function(){var e=this.goods_list;console.log("li",e);var t=0;for(var s in e){var i=e[s],o=i.goods.price,n=parseFloat(o)*parseFloat(i.number);t+=n}this.goodsTotal=this.$round2pos(t)},discard:function(){},sub:function(e){if(!(e.number<=1)){var t=1;1==e.goods.type&&(t=1),e.number=e.number-t}},add:function(e){console.log(e);var t=1;1==e.goods.type&&(t=1),e.number=parseFloat(e.number)+parseFloat(t)},choseCoupon:function(e){this.cur_coupon=e,this.toggleMask()},toggleMask:function(e){var t=this,s="show"===e?10:300,i="show"===e?1:0;this.maskState=2,setTimeout((function(){t.maskState=i}),s)},numberChange:function(e){this.number=e.number},changePayType:function(e){this.payType=e},submit:function(){this._submit()},_submit:function(){if("点击添加收货地址"!=this.addressData.name)if(this.addressData.pickerText){var e={};e.amount=this.goodsTotal,e.benefit=this.cur_coupon.price,e.postage=this.postage,e.address=JSON.stringify(this.addressData);var t=[],s=1;for(var i in this.goods_list){var o=this.goods_list[i],n={};n.id=o.goods.id,n.name=o.goods.name,n.image=o.goods.image,n.type=o.goods.type,n.sku=o.sku.sku,n.price=o.sku.price,n.buyNum=o.number,t.push(n)}e.type=s,e.goodsDetail=JSON.stringify(t),e.goodsMemo=this.goods_list[0].goods.name,e.memo=this.desc||"memo";var a={};if(this.$isNull(this.userInfo.id))this.$toast("请先登陆");else if(a.id=this.userInfo.id,this.userInfo.headimage&&(a.headimage=this.userInfo.headimage),this.userInfo.mobile&&(a.mobile=this.userInfo.mobile),this.userInfo.nickname&&(a.nickname=this.userInfo.nickname),e.userDetail=JSON.stringify(a),e.userId=this.userInfo.id,1!=this.submit_lock){this.submit_lock=1;var r=this;this.$post("order/create",e,(function(e){var t=e.data.id,s=r.goodsTotal-r.cur_coupon.price+r.postage;r.isH5()?r.$naviExter("./external/wxpay.html?order_id="+t+"&money="+s):r.$redirectTo("/pages/pay/pay?order_id="+t+"&money="+s)}))}}else this.$toast("请选择邮寄区域");else this.$toast("请填写地址")},stopPrevent:function(){}}};t.default=s}).call(this,s(2)["default"])},232:function(e,t,s){"use strict";s.r(t);var i=s(233),o=s.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){s.d(t,e,(function(){return i[e]}))}(n);t["default"]=o.a},233:function(e,t,s){}},[[226,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/order/create.js.map